{"version":3,"sources":["directives/colorPalette.ts"],"names":["colorPalette","setModel","bindClickDocument","bindMouseMove","setClickHandler","colorToHex","componentToHex","imageChanged"],"mappings":"AACA,CAAC;IACC,OAAO,CACJ,MAAM,CAAC,uBAAuB,CAAC,CAC/B,SAAS,CAAC,cAAc,EAAE,YAAY,CAAC,CAAC;IAE3C,YAAY,CAAC,OAAO,GAAG,CAAC,WAAW,CAAC,CAAC;IAErC,SAAS,YAAY,CAAC,SAAS;QAC7BA,MAAMA,CAACA;YACLA,QAAQA,EAAEA,GAAGA;YAEbA,WAAWA,EAAEA,yBAAyBA;YACtCA,IAAIA,EAAEA,UAASA,KAAKA,EAAEA,OAAOA,EAAEA,KAAKA;gBAElC,IAAI,QAAQ,CAAC;gBACb,KAAK,CAAC,GAAG,CAAC,cAAc,EAAE,YAAY,CAAC,CAAC;gBACxC,KAAK,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;gBAEhC,SAAS,QAAQ,CAAC,KAAK,EAAE,IAAI;oBAC3BC,SAASA,CAACA,IAAIA,CAACA,OAAOA,EAAEA,iBAAiBA,CAACA,CAACA;oBAC3CA,KAAKA,CAACA,MAAMA,GAAGA,IAAIA,CAACA,KAAKA,CAACA;oBAC1BA,QAAQA,GAAGA,OAAOA,CAACA,IAAIA,CAACA,SAASA,CAACA,CAACA;oBACnCA,QAAQA,CAACA,IAAIA,CAACA,WAAWA,EAAEA,aAAaA,CAACA,CAACA;oBAC1CA,QAAQA,CAACA,IAAIA,CAACA,OAAOA,EAAEA,eAAeA,CAACA,CAACA;gBAC1CA,CAACA;gBAAA,CAAC;gBAEF,SAAS,iBAAiB,CAAC,KAAK;oBAC9BC,IAAIA,OAAOA,GAAGA,OAAOA,CAACA,GAAGA,CAACA,KAAKA,CAACA,MAAMA,CAACA,CAACA,MAAMA,GAAGA,CAACA,CAACA;oBACnDA,IAAIA,MAAMA,GAAGA,OAAOA,CAACA,CAACA,CAACA,KAAKA,KAAKA,CAACA,MAAMA,CAACA;oBACzCA,IAAIA,QAAQA,GAAGA,OAAOA,IAAIA,MAAMA,CAACA;oBAEjCA,EAAEA,CAACA,CAACA,CAACA,QAAQA,CAACA,CAACA,CAACA;wBACdA,SAASA,CAACA,MAAMA,CAACA,OAAOA,EAAEA,iBAAiBA,CAACA,CAACA;wBAC7CA,QAAQA,CAACA,MAAMA,CAACA,WAAWA,EAAEA,aAAaA,CAACA,CAACA;wBAC5CA,QAAQA,CAACA,MAAMA,CAACA,OAAOA,EAAEA,eAAeA,CAACA,CAACA;oBAC5CA,CAACA;gBACHA,CAACA;gBAED,SAAS,aAAa,CAAC,CAAC;oBACtBC,KAAKA,CAACA,GAAGA,CAACA,KAAKA,CAACA,KAAKA,CAACA,MAAMA,CAACA,GAAGA,UAAUA,CAACA,CAACA,CAACA,IAAIA,CAACA,CAACA,GAAGA,CAACA,kBAAkBA,CAACA,CAACA,CAACA;oBAC5EA,KAAKA,CAACA,MAAMA,EAAEA,CAACA;gBAEjBA,CAACA;gBAAA,CAAC;gBAEF,SAAS,eAAe,CAAC,CAAC;oBACxBC,KAAKA,CAACA,GAAGA,CAACA,KAAKA,CAACA,KAAKA,CAACA,MAAMA,CAACA,GAAGA,UAAUA,CAACA,CAACA,CAACA,IAAIA,CAACA,CAACA,GAAGA,CAACA,kBAAkBA,CAACA,CAACA,CAACA;oBAC5EA,KAAKA,CAACA,MAAMA,EAAEA,CAACA;oBAEfA,QAAQA,CAACA,MAAMA,CAACA,OAAOA,EAAEA,eAAeA,CAACA,CAACA;oBAC1CA,QAAQA,CAACA,MAAMA,CAACA,WAAWA,EAAEA,aAAaA,CAACA,CAACA;gBAC9CA,CAACA;gBAAA,CAAC;gBAED,SAAS,UAAU,CAAC,KAAK;oBACxBC,OAAOA,CAACA,GAAGA,CAACA,KAAKA,CAACA,CAACA;oBACnBA,EAAEA,CAACA,CAACA,KAAKA,CAACA,MAAMA,CAACA,CAACA,EAAEA,CAACA,CAACA,KAAKA,GAAGA,CAACA,CAACA,CAACA;wBAC/BA,MAAMA,CAACA,KAAKA,CAACA;oBACfA,CAACA;oBACDA,IAAIA,MAAMA,GAAGA,iCAAiCA,CAACA,IAAIA,CAACA,KAAKA,CAACA,CAACA;oBAE3DA,IAAIA,GAAGA,GAAGA,QAAQA,CAACA,MAAMA,CAACA,CAACA,CAACA,CAACA,CAACA;oBAC9BA,IAAIA,KAAKA,GAAGA,QAAQA,CAACA,MAAMA,CAACA,CAACA,CAACA,CAACA,CAACA;oBAChCA,IAAIA,IAAIA,GAAGA,QAAQA,CAACA,MAAMA,CAACA,CAACA,CAACA,CAACA,CAACA;oBAE/BA,IAAIA,GAAGA,GAAGA,IAAIA,GAAGA,KAAKA,IAAIA,CAACA,GAAGA,GAAGA,IAAIA,EAAEA,CAACA;oBACxCA,MAAMA,CAACA,MAAMA,CAACA,CAACA,CAACA,GAAGA,GAAGA,GAAGA,GAAGA,CAACA,QAAQA,CAACA,EAAEA,CAACA,CAACA;gBAC5CA,CAACA;gBAAA,CAAC;gBAGF,KAAK,CAAC,QAAQ,GAAG,UAAS,GAAG;oBAC3B,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;oBAAC,CAAC;oBACjB,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;oBAAC,CAAC;oBACjB,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;oBACf,MAAM,CAAC,GAAG,GAAG,cAAc,CAAC,CAAC,CAAC,GAAG,cAAc,CAAC,CAAC,CAAC,GAAG,cAAc,CAAC,CAAC,CAAC,CAAC;gBACzE,CAAC,CAAC;gBAEF,SAAS,cAAc,CAAC,CAAC;oBACvBC,IAAIA,GAAGA,GAAGA,CAACA,CAACA,QAAQA,CAACA,EAAEA,CAACA,CAACA;oBACzBA,MAAMA,CAACA,GAAGA,CAACA,MAAMA,KAAKA,CAACA,GAAGA,GAAGA,GAAGA,GAAGA,GAAGA,GAAGA,CAACA;gBAC5CA,CAACA;gBAED,SAAS,YAAY,CAAC,KAAK,EAAE,IAAI;oBAE/BC,IAAIA,QAAQA,GAAGA,IAAIA,CAACA,KAAKA,CAACA,QAAQA,EAAEA,CAACA;oBACrCA,IAAIA,UAAUA,GAAOA,IAAIA,UAAUA,EAAEA,CAACA;oBACtCA,IAAIA,OAAOA,GAAGA,UAAUA,CAACA,UAAUA,CAACA,QAAQA,CAACA,CAACA;oBAC9CA,KAAKA,CAACA,OAAOA,GAAGA,OAAOA,CAACA;oBACxBA,OAAOA,CAACA,GAAGA,CAACA,OAAOA,CAACA,CAACA;gBACvBA,CAACA;YACH,CAAC;SACFP,CAACA;IACJA,CAACA;AACH,CAAC,CAAC,EAAE,CAAC","file":"directives/colorPalette.js","sourceRoot":"/home/soka/Workspace/vectorizer.js/","sourcesContent":["declare var ColorThief:any;\n(function() {\n  angular\n    .module('Vectorizer.directives')\n    .directive('colorPalette', colorPalette);\n\n  colorPalette.$inject = ['$document'];\n\n  function colorPalette($document) {\n    return {\n      restrict: 'E',\n\n      templateUrl: 'views/colorPalette.html',\n      link: function(scope, element, attrs) {\n\n        var elements;\n        scope.$on('imageChanged', imageChanged);\n        scope.$on('setModel', setModel);\n\n        function setModel(event, data) {\n          $document.bind('click', bindClickDocument);\n          scope.picker = data.model;\n          elements = element.find('.swatch');\n          elements.bind('mousemove', bindMouseMove);\n          elements.bind('click', setClickHandler);\n        };\n\n        function bindClickDocument(event) {\n          var isChild = element.has(event.target).length > 0;\n          var isSelf = element[0] === event.target;\n          var isInside = isChild || isSelf;\n\n          if (!isInside) {\n            $document.unbind('click', bindClickDocument);\n            elements.unbind('mousemove', bindMouseMove);\n            elements.unbind('click', setClickHandler);\n          }\n        }\n\n        function bindMouseMove(e) {\n          scope.app.input[scope.picker] = colorToHex($(this).css('background-color'));\n          scope.$apply();\n\n        };\n\n        function setClickHandler(e) {\n          scope.app.input[scope.picker] = colorToHex($(this).css('background-color'));\n          scope.$apply();\n\n          elements.unbind('click', setClickHandler);\n          elements.unbind('mousemove', bindMouseMove);\n        };\n\n         function colorToHex(color) {\n          console.log(color);\n          if (color.substr(0, 1) === '#') {\n            return color;\n          }\n          var digits = /(.*?)rgb\\((\\d+), (\\d+), (\\d+)\\)/.exec(color);\n\n          var red = parseInt(digits[2]);\n          var green = parseInt(digits[3]);\n          var blue = parseInt(digits[4]);\n\n          var rgb = blue | green << 8 | red << 16;\n          return digits[1] + '#' + rgb.toString(16);\n        };\n\n\n        scope.rgbToHex = function(arr) {\n          var r = arr[0]; ;\n          var g = arr[1]; ;\n          var b = arr[2];\n          return '#' + componentToHex(r) + componentToHex(g) + componentToHex(b);\n        };\n\n        function componentToHex(c) {\n          var hex = c.toString(16);\n          return hex.length === 1 ? '0' + hex : hex;\n        }\n\n        function imageChanged(event, data) {\n\n          var imageObj = data.image.getImage();\n          var colorThief:any = new ColorThief();\n          var palette = colorThief.getPalette(imageObj);\n          scope.palette = palette;\n          console.log(palette);\n        }\n      }\n    };\n  }\n})();"]}